<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campeonato nacional de gp colombia - Informe III VAL copa dream expirience</title>
    <link rel="icon" type="image/png" href="../../fedemoto-logo.png">
    <!-- Librer√≠as para generar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- SweetAlert2 para modales -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            padding-top: 120px;
            min-height: 100vh;
        }

        /* Header fijo con men√∫ */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #123E92;
            color: white;
            z-index: 10000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            width: 100%;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 30px;
            width: 100%;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-container img {
            height: 50px;
            width: auto;
        }

        .logo-container h1 {
            font-size: 1.8em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .nav-menu {
            display: flex;
            gap: 0;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-menu li {
            margin: 0;
            padding: 0;
            position: relative;
        }

        .nav-menu > li > a {
            display: block;
            padding: 12px 25px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1em;
            transition: all 0.3s;
            border-radius: 5px;
            position: relative;
            white-space: nowrap;
            cursor: pointer;
        }

        .nav-menu > li > a:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }

        .nav-menu > li > a.active {
            background: #F7C31D;
            color: #123E92;
        }

        /* Men√∫ desplegable */
        .dropdown {
            position: relative;
        }

        .dropdown > a::after {
            content: ' ‚ñº';
            font-size: 0.8em;
            margin-left: 5px;
        }

        /* Puente invisible para mantener el hover activo */
        .dropdown::before {
            content: '';
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            height: 5px;
            background: transparent;
            z-index: 10002;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            background: white;
            min-width: 200px;
            width: 220px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            border-radius: 8px;
            z-index: 10001;
            list-style: none;
            padding: 0;
            margin: 0;
            overflow: visible;
        }
        
        /* Submen√∫s dentro de dropdowns (para Motocross, Velotierra, etc.) */
        .dropdown-menu .dropdown {
            position: relative;
        }
        
        /* Puente invisible para submen√∫s anidados */
        .dropdown-menu .dropdown::before {
            content: '';
            position: absolute;
            top: 0;
            left: 100%;
            width: 10px;
            height: 100%;
            background: transparent;
            z-index: 10004;
        }
        
        .dropdown-menu .dropdown > a {
            position: relative;
            padding-right: 35px;
        }
        
        .dropdown-menu .dropdown > a::after {
            content: ' ‚ñ∂';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8em;
            margin: 0;
            float: none;
        }
        
        .dropdown-menu .dropdown .dropdown-menu {
            display: none !important;
            position: absolute;
            left: 100%;
            top: 0;
            margin-left: 5px;
            z-index: 10003;
            min-width: 180px;
            background: white;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            border-radius: 8px;
            overflow: visible;
        }
        
        /* En "Resultados generales", mostrar submen√∫s a la izquierda */
        .nav-menu > .dropdown:nth-child(4) .dropdown-menu > .dropdown > .dropdown-menu {
            left: auto;
            right: 100%;
            margin-left: 0;
            margin-right: 5px;
        }
        
        .dropdown-menu .dropdown:hover > .dropdown-menu {
            display: block !important;
        }

        /* Solo aplicar hover al primer nivel de dropdown (no a submen√∫s anidados) */
        .nav-menu > .dropdown:hover > .dropdown-menu,
        .nav-menu > .dropdown.active > .dropdown-menu {
            display: block;
            animation: fadeInDown 0.3s ease;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-menu li {
            margin: 0;
            position: relative;
        }

        .dropdown-menu a {
            display: block;
            padding: 12px 20px;
            color: #333;
            text-decoration: none;
            font-size: 1em;
            transition: all 0.2s;
            border-bottom: 1px solid #f0f0f0;
        }

        .dropdown-menu a:last-child {
            border-bottom: none;
        }

        .dropdown-menu a:hover {
            background: #f8f9fa;
            color: #123E92;
        }
        
        /* Los elementos con submen√∫ mantienen el padding al hacer hover */
        .dropdown-menu .dropdown > a:hover {
            padding-left: 20px;
        }

        .dropdown-menu a.active {
            background: #F7C31D;
            color: #123E92;
            font-weight: 600;
        }

        .dropdown.active > a {
            background: rgba(255,255,255,0.15);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .container > header {
            background: #123E92;
            color: white;
            padding: 40px;
            text-align: center;
        }

        .container > header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .container > header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .stat-card .number {
            font-size: 3em;
            font-weight: bold;
            color: #123E92;
            margin-bottom: 10px;
        }

        .stat-card .label {
            font-size: 1.1em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .section {
            padding: 40px;
            border-bottom: 1px solid #e0e0e0;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section h2 {
            font-size: 2em;
            color: #123E92;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #F7C31D;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 100%;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 100%;
        }

        .bar-label {
            min-width: 120px;
            max-width: 120px;
            font-weight: 500;
            color: #333;
            font-size: 0.9em;
            flex-shrink: 0;
        }

        .bar-wrapper {
            flex: 1;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: flex-end;
        }

        .bar-fill {
            height: 100%;
            background: #123E92;
            border-radius: 15px;
            transition: width 1s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        /* Gr√°fica de columnas verticales */
        .column-chart {
            display: flex;
            flex-direction: row;
            align-items: flex-end;
            justify-content: space-around;
            gap: 15px;
            min-height: 300px;
            padding: 20px 0;
        }

        .column-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 60px;
            max-width: 120px;
        }

        .column-wrapper {
            width: 100%;
            height: 250px;
            background: #e0e0e0;
            border-radius: 5px 5px 0 0;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .column-fill {
            width: 100%;
            background: #123E92;
            border-radius: 5px 5px 0 0;
            transition: height 1s ease-out;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 5px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
            min-height: 20px;
            position: relative;
        }

        .column-label {
            margin-top: 10px;
            font-weight: 500;
            color: #333;
            font-size: 0.85em;
            text-align: center;
            word-wrap: break-word;
            max-width: 100%;
        }

        .filters-container {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 1em;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }

        .search-box:focus {
            outline: none;
            border-color: #F7C31D;
        }

        .filter-select {
            padding: 15px;
            font-size: 1em;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
            width: 100%;
            box-sizing: border-box;
        }

        .filter-select:focus {
            outline: none;
            border-color: #F7C31D;
        }

        footer {
            background: #f8f9fa;
            padding: 30px 40px;
            text-align: center;
            border-top: 1px solid #e0e0e0;
            color: #666;
            font-size: 0.9em;
            line-height: 1.8;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
                padding-top: 150px;
            }

            .header-content {
                flex-direction: column;
                padding: 15px 20px;
            }

            .logo-container {
                margin-bottom: 15px;
            }

            .nav-menu {
                flex-direction: column;
                width: 100%;
                gap: 5px;
            }

            .dropdown-menu {
                position: static;
                display: none;
                box-shadow: none;
                border-radius: 0;
                background: rgba(255,255,255,0.1);
            }

            .nav-menu > .dropdown:hover > .dropdown-menu,
            .nav-menu > .dropdown.active > .dropdown-menu {
                display: block;
            }

            .dropdown-menu a {
                color: white;
                padding: 10px 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .section {
                padding: 25px 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Contenedor para el men√∫ (se carga din√°micamente desde menu.html) -->
    <div id="menu-container"></div>

    <div class="container">
        <header>
            <h1>
                <img src="../../fedemoto-logo.png" alt="FEDEMOTO Logo" style="height: 60px; vertical-align: middle; margin-right: 15px;">
                Campeonato nacional de gp colombia - Informe III VAL copa dream expirience
            </h1>
            <p>An√°lisis completo de participantes y categor√≠as</p>
        </header>

        <div id="content">
            <!-- Estad√≠sticas principales -->
            <div class="stats-grid" id="statsGrid">
                <!-- Se llenar√° con JavaScript -->
            </div>

            <!-- Secci√≥n 1: Participaci√≥n por edad -->
            <div class="section">
                <h2>üéÇ Participaci√≥n por edad</h2>
                <div class="chart-container">
                    <div class="column-chart" id="edadChart">
                        <!-- Se llenar√° con JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 2: Pilotos por categor√≠a -->
            <div class="section">
                <h2>üèÜ Pilotos por categor√≠a</h2>
                <div class="chart-container">
                    <div class="bar-chart" id="categoriaChart">
                        <!-- Se llenar√° con JavaScript -->
                    </div>
                </div>
            </div>

            

            <!-- Secci√≥n 3: Deportistas por ligas totales -->
            <div class="section">
                <h2>üåé Deportistas por ligas totales</h2>
                <div class="filters-container">
                    <input type="text" class="search-box" id="searchLiga" placeholder="üîç Buscar liga...">
                    <select class="filter-select" id="filterSortLiga">
                        <option value="cantidad-desc">Ordenar por cantidad (mayor a menor)</option>
                        <option value="cantidad-asc">Ordenar por cantidad (menor a mayor)</option>
                        <option value="nombre-asc">Ordenar por nombre (A-Z)</option>
                        <option value="nombre-desc">Ordenar por nombre (Z-A)</option>
                    </select>
                </div>
                <div class="chart-container">
                    <div class="bar-chart" id="ligasChart">
                        <!-- Se llenar√° con JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 4: Deportistas por ligas por categor√≠a -->
            <div class="section">
                <h2>üìà Deportistas por ligas por categor√≠a</h2>
                <div class="filters-container" style="grid-template-columns: 1fr; max-width: 400px; margin-bottom: 30px;">
                    <select class="filter-select" id="filtroCategoriaLiga">
                        <option value="">Seleccione un filtro</option>
                    </select>
                </div>
                <div id="todasCategoriasLigaCharts">
                    <!-- Se llenar√° con todas las gr√°ficas de categor√≠as -->
                </div>
            </div>

            
        </div>

        <footer>
            <p><span class="developer">Developed by Mauricio S√°nchez Aguilar - Fedemoto</span></p>
            <p>Este proyecto es de uso interno de FEDEMOTO.</p>
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
                <button id="descargarPDF" style="background: #123E92; color: white; border: none; padding: 15px 40px; font-size: 1.1em; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.2);" onmouseover="this.style.background='#0d2d6b'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 15px rgba(0,0,0,0.3)';" onmouseout="this.style.background='#123E92'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 10px rgba(0,0,0,0.2)';">
                    üì• Descargar PDF
                </button>
                <p style="margin-top: 10px; color: #666; font-size: 0.9em;">Descarga este informe completo con todas las gr√°ficas en formato PDF</p>
            </div>
        </footer>
    </div>

    <script>
        // Datos incrustados directamente para evitar problemas de CORS
        const datos = {
  "total_pilotos_unicos": 232,
  "total_participaciones": 464,
  "pilotos_por_categoria": {
    "115 CC ELITE": 42,
    "115 CC INFANTIL": 14,
    "115 CC INICIO": 29,
    "115 CC MAS": 15,
    "150 CC": 31,
    "150 CC INICIO": 18,
    "150 CC MAS": 15,
    "200 CC 2T": 21,
    "220 CC 4T": 29,
    "CRS EXP": 26,
    "CRS NOV": 41,
    "FEMENINA": 7,
    "LGP MOB": 4,
    "MINI 190": 5,
    "MINI GP": 10,
    "MINIMOTARD": 9,
    "R15": 17,
    "SS 1000": 5,
    "SS 600": 10,
    "STR 250": 37,
    "SUPER BIKE": 16,
    "SUPERMOT EXPERTOS": 18,
    "SUPERMOT NOVATOS": 21,
    "SUPERSPORT": 9,
    "X BIKE A": 9,
    "X BIKE B": 6
  },
  "deportistas_por_liga_total": {
    "ANTIOQUIA": 41,
    "BOGOTA": 39,
    "CALDAS": 5,
    "CAUCA": 4,
    "CESAR": 12,
    "CUNDINAMARCA": 26,
    "HUILA": 7,
    "META": 7,
    "MEXICO": 1,
    "NARINO": 2,
    "PUTUMAYO": 7,
    "QUINDIO": 7,
    "SANTANDER": 12,
    "TOLIMA": 51,
    "VALLE": 11
  },
  "deportistas_por_liga_categoria": {
    "115 CC ELITE": {
      "ANTIOQUIA": 7,
      "BOGOTA": 1,
      "CALDAS": 2,
      "CAUCA": 2,
      "CESAR": 2,
      "CUNDINAMARCA": 4,
      "META": 5,
      "NARINO": 1,
      "PUTUMAYO": 2,
      "QUINDIO": 3,
      "SANTANDER": 2,
      "TOLIMA": 7,
      "VALLE": 4
    },
    "115 CC INFANTIL": {
      "ANTIOQUIA": 1,
      "BOGOTA": 1,
      "CESAR": 5,
      "CUNDINAMARCA": 1,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 2,
      "VALLE": 2
    },
    "115 CC INICIO": {
      "ANTIOQUIA": 3,
      "BOGOTA": 1,
      "CESAR": 5,
      "CUNDINAMARCA": 3,
      "HUILA": 2,
      "META": 2,
      "PUTUMAYO": 2,
      "QUINDIO": 3,
      "SANTANDER": 3,
      "TOLIMA": 1,
      "VALLE": 4
    },
    "115 CC MAS": {
      "ANTIOQUIA": 6,
      "CALDAS": 1,
      "CAUCA": 1,
      "CUNDINAMARCA": 2,
      "NARINO": 1,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 2
    },
    "150 CC": {
      "ANTIOQUIA": 5,
      "BOGOTA": 1,
      "CALDAS": 1,
      "CAUCA": 1,
      "CUNDINAMARCA": 5,
      "META": 5,
      "NARINO": 1,
      "PUTUMAYO": 3,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 4,
      "VALLE": 3
    },
    "150 CC INICIO": {
      "ANTIOQUIA": 2,
      "BOGOTA": 2,
      "CESAR": 2,
      "CUNDINAMARCA": 1,
      "HUILA": 1,
      "META": 2,
      "PUTUMAYO": 1,
      "QUINDIO": 3,
      "SANTANDER": 2,
      "TOLIMA": 1,
      "VALLE": 1
    },
    "150 CC MAS": {
      "ANTIOQUIA": 3,
      "CALDAS": 2,
      "CUNDINAMARCA": 2,
      "NARINO": 1,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 5
    },
    "200 CC 2T": {
      "ANTIOQUIA": 3,
      "CAUCA": 2,
      "CUNDINAMARCA": 3,
      "META": 2,
      "NARINO": 1,
      "PUTUMAYO": 3,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 2,
      "VALLE": 3
    },
    "220 CC 4T": {
      "ANTIOQUIA": 1,
      "BOGOTA": 3,
      "CAUCA": 2,
      "CUNDINAMARCA": 7,
      "HUILA": 1,
      "META": 2,
      "SANTANDER": 1,
      "TOLIMA": 11,
      "VALLE": 1
    },
    "CRS EXP": {
      "ANTIOQUIA": 1,
      "BOGOTA": 4,
      "CUNDINAMARCA": 8,
      "HUILA": 1,
      "META": 4,
      "PUTUMAYO": 1,
      "TOLIMA": 6,
      "VALLE": 1
    },
    "CRS NOV": {
      "ANTIOQUIA": 7,
      "BOGOTA": 5,
      "CAUCA": 1,
      "CESAR": 1,
      "CUNDINAMARCA": 8,
      "HUILA": 3,
      "PUTUMAYO": 1,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 12,
      "VALLE": 1
    },
    "FEMENINA": {
      "BOGOTA": 2,
      "CUNDINAMARCA": 3,
      "SANTANDER": 1,
      "TOLIMA": 1
    },
    "LGP MOB": {
      "BOGOTA": 1,
      "MEXICO": 1,
      "TOLIMA": 1,
      "VALLE": 1
    },
    "MINI 190": {
      "ANTIOQUIA": 1,
      "BOGOTA": 2,
      "CESAR": 1,
      "TOLIMA": 1
    },
    "MINI GP": {
      "ANTIOQUIA": 2,
      "BOGOTA": 1,
      "CESAR": 3,
      "META": 1,
      "SANTANDER": 1,
      "TOLIMA": 2
    },
    "MINIMOTARD": {
      "ANTIOQUIA": 5,
      "CALDAS": 2,
      "SANTANDER": 1,
      "VALLE": 1
    },
    "R15": {
      "ANTIOQUIA": 1,
      "BOGOTA": 4,
      "CAUCA": 1,
      "HUILA": 3,
      "SANTANDER": 2,
      "TOLIMA": 6
    },
    "SS 1000": {
      "ANTIOQUIA": 2,
      "BOGOTA": 2,
      "PUTUMAYO": 1
    },
    "SS 600": {
      "ANTIOQUIA": 1,
      "BOGOTA": 6,
      "SANTANDER": 1,
      "TOLIMA": 1,
      "VALLE": 1
    },
    "STR 250": {
      "ANTIOQUIA": 3,
      "BOGOTA": 5,
      "CAUCA": 1,
      "CESAR": 1,
      "CUNDINAMARCA": 9,
      "HUILA": 1,
      "META": 2,
      "PUTUMAYO": 2,
      "TOLIMA": 13
    },
    "SUPER BIKE": {
      "ANTIOQUIA": 5,
      "BOGOTA": 5,
      "CUNDINAMARCA": 2,
      "NARINO": 1,
      "SANTANDER": 1,
      "TOLIMA": 2
    },
    "SUPERMOT EXPERTOS": {
      "ANTIOQUIA": 6,
      "BOGOTA": 1,
      "CUNDINAMARCA": 2,
      "META": 2,
      "NARINO": 1,
      "PUTUMAYO": 1,
      "QUINDIO": 1,
      "SANTANDER": 1,
      "TOLIMA": 2,
      "VALLE": 1
    },
    "SUPERMOT NOVATOS": {
      "ANTIOQUIA": 6,
      "BOGOTA": 4,
      "CUNDINAMARCA": 2,
      "MEXICO": 1,
      "TOLIMA": 7,
      "VALLE": 1
    },
    "SUPERSPORT": {
      "ANTIOQUIA": 2,
      "BOGOTA": 6,
      "MEXICO": 1
    },
    "X BIKE A": {
      "ANTIOQUIA": 2,
      "BOGOTA": 4,
      "CALDAS": 1,
      "CAUCA": 1,
      "VALLE": 1
    },
    "X BIKE B": {
      "ANTIOQUIA": 1,
      "BOGOTA": 1,
      "CUNDINAMARCA": 1,
      "TOLIMA": 3
    }
  },
  "participaciones_por_edad": {
    "1-5 a√±os": 1,
    "11-15 a√±os": 19,
    "16-20 a√±os": 16,
    "21-25 a√±os": 23,
    "26-30 a√±os": 57,
    "31-35 a√±os": 54,
    "36-40 a√±os": 26,
    "41-45 a√±os": 19,
    "46-50 a√±os": 10,
    "51-55 a√±os": 1,
    "56-60 a√±os": 1,
    "6-10 a√±os": 2
  },
  "modalidades": {
    "Hoja1": {
      "pilotos_unicos": 232,
      "total_participaciones": 464,
      "pilotos_por_categoria": {
        "115 CC ELITE": 42,
        "115 CC INFANTIL": 14,
        "115 CC INICIO": 29,
        "115 CC MAS": 15,
        "150 CC": 31,
        "150 CC INICIO": 18,
        "150 CC MAS": 15,
        "200 CC 2T": 21,
        "220 CC 4T": 29,
        "CRS EXP": 26,
        "CRS NOV": 41,
        "FEMENINA": 7,
        "LGP MOB": 4,
        "MINI 190": 5,
        "MINI GP": 10,
        "MINIMOTARD": 9,
        "R15": 17,
        "SS 1000": 5,
        "SS 600": 10,
        "STR 250": 37,
        "SUPER BIKE": 16,
        "SUPERMOT EXPERTOS": 18,
        "SUPERMOT NOVATOS": 21,
        "SUPERSPORT": 9,
        "X BIKE A": 9,
        "X BIKE B": 6
      },
      "deportistas_por_liga": {
        "ANTIOQUIA": 41,
        "BOGOTA": 39,
        "CALDAS": 5,
        "CAUCA": 4,
        "CESAR": 12,
        "CUNDINAMARCA": 26,
        "HUILA": 7,
        "META": 7,
        "MEXICO": 1,
        "NARINO": 2,
        "PUTUMAYO": 7,
        "QUINDIO": 7,
        "SANTANDER": 12,
        "TOLIMA": 51,
        "VALLE": 11
      },
      "deportistas_por_liga_categoria": {
        "115 CC ELITE": {
          "ANTIOQUIA": 7,
          "BOGOTA": 1,
          "CALDAS": 2,
          "CAUCA": 2,
          "CESAR": 2,
          "CUNDINAMARCA": 4,
          "META": 5,
          "NARINO": 1,
          "PUTUMAYO": 2,
          "QUINDIO": 3,
          "SANTANDER": 2,
          "TOLIMA": 7,
          "VALLE": 4
        },
        "115 CC INFANTIL": {
          "ANTIOQUIA": 1,
          "BOGOTA": 1,
          "CESAR": 5,
          "CUNDINAMARCA": 1,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 2,
          "VALLE": 2
        },
        "115 CC INICIO": {
          "ANTIOQUIA": 3,
          "BOGOTA": 1,
          "CESAR": 5,
          "CUNDINAMARCA": 3,
          "HUILA": 2,
          "META": 2,
          "PUTUMAYO": 2,
          "QUINDIO": 3,
          "SANTANDER": 3,
          "TOLIMA": 1,
          "VALLE": 4
        },
        "115 CC MAS": {
          "ANTIOQUIA": 6,
          "CALDAS": 1,
          "CAUCA": 1,
          "CUNDINAMARCA": 2,
          "NARINO": 1,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 2
        },
        "150 CC": {
          "ANTIOQUIA": 5,
          "BOGOTA": 1,
          "CALDAS": 1,
          "CAUCA": 1,
          "CUNDINAMARCA": 5,
          "META": 5,
          "NARINO": 1,
          "PUTUMAYO": 3,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 4,
          "VALLE": 3
        },
        "150 CC INICIO": {
          "ANTIOQUIA": 2,
          "BOGOTA": 2,
          "CESAR": 2,
          "CUNDINAMARCA": 1,
          "HUILA": 1,
          "META": 2,
          "PUTUMAYO": 1,
          "QUINDIO": 3,
          "SANTANDER": 2,
          "TOLIMA": 1,
          "VALLE": 1
        },
        "150 CC MAS": {
          "ANTIOQUIA": 3,
          "CALDAS": 2,
          "CUNDINAMARCA": 2,
          "NARINO": 1,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 5
        },
        "200 CC 2T": {
          "ANTIOQUIA": 3,
          "CAUCA": 2,
          "CUNDINAMARCA": 3,
          "META": 2,
          "NARINO": 1,
          "PUTUMAYO": 3,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 2,
          "VALLE": 3
        },
        "220 CC 4T": {
          "ANTIOQUIA": 1,
          "BOGOTA": 3,
          "CAUCA": 2,
          "CUNDINAMARCA": 7,
          "HUILA": 1,
          "META": 2,
          "SANTANDER": 1,
          "TOLIMA": 11,
          "VALLE": 1
        },
        "CRS EXP": {
          "ANTIOQUIA": 1,
          "BOGOTA": 4,
          "CUNDINAMARCA": 8,
          "HUILA": 1,
          "META": 4,
          "PUTUMAYO": 1,
          "TOLIMA": 6,
          "VALLE": 1
        },
        "CRS NOV": {
          "ANTIOQUIA": 7,
          "BOGOTA": 5,
          "CAUCA": 1,
          "CESAR": 1,
          "CUNDINAMARCA": 8,
          "HUILA": 3,
          "PUTUMAYO": 1,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 12,
          "VALLE": 1
        },
        "FEMENINA": {
          "BOGOTA": 2,
          "CUNDINAMARCA": 3,
          "SANTANDER": 1,
          "TOLIMA": 1
        },
        "LGP MOB": {
          "BOGOTA": 1,
          "MEXICO": 1,
          "TOLIMA": 1,
          "VALLE": 1
        },
        "MINI 190": {
          "ANTIOQUIA": 1,
          "BOGOTA": 2,
          "CESAR": 1,
          "TOLIMA": 1
        },
        "MINI GP": {
          "ANTIOQUIA": 2,
          "BOGOTA": 1,
          "CESAR": 3,
          "META": 1,
          "SANTANDER": 1,
          "TOLIMA": 2
        },
        "MINIMOTARD": {
          "ANTIOQUIA": 5,
          "CALDAS": 2,
          "SANTANDER": 1,
          "VALLE": 1
        },
        "R15": {
          "ANTIOQUIA": 1,
          "BOGOTA": 4,
          "CAUCA": 1,
          "HUILA": 3,
          "SANTANDER": 2,
          "TOLIMA": 6
        },
        "SS 1000": {
          "ANTIOQUIA": 2,
          "BOGOTA": 2,
          "PUTUMAYO": 1
        },
        "SS 600": {
          "ANTIOQUIA": 1,
          "BOGOTA": 6,
          "SANTANDER": 1,
          "TOLIMA": 1,
          "VALLE": 1
        },
        "STR 250": {
          "ANTIOQUIA": 3,
          "BOGOTA": 5,
          "CAUCA": 1,
          "CESAR": 1,
          "CUNDINAMARCA": 9,
          "HUILA": 1,
          "META": 2,
          "PUTUMAYO": 2,
          "TOLIMA": 13
        },
        "SUPER BIKE": {
          "ANTIOQUIA": 5,
          "BOGOTA": 5,
          "CUNDINAMARCA": 2,
          "NARINO": 1,
          "SANTANDER": 1,
          "TOLIMA": 2
        },
        "SUPERMOT EXPERTOS": {
          "ANTIOQUIA": 6,
          "BOGOTA": 1,
          "CUNDINAMARCA": 2,
          "META": 2,
          "NARINO": 1,
          "PUTUMAYO": 1,
          "QUINDIO": 1,
          "SANTANDER": 1,
          "TOLIMA": 2,
          "VALLE": 1
        },
        "SUPERMOT NOVATOS": {
          "ANTIOQUIA": 6,
          "BOGOTA": 4,
          "CUNDINAMARCA": 2,
          "MEXICO": 1,
          "TOLIMA": 7,
          "VALLE": 1
        },
        "SUPERSPORT": {
          "ANTIOQUIA": 2,
          "BOGOTA": 6,
          "MEXICO": 1
        },
        "X BIKE A": {
          "ANTIOQUIA": 2,
          "BOGOTA": 4,
          "CALDAS": 1,
          "CAUCA": 1,
          "VALLE": 1
        },
        "X BIKE B": {
          "ANTIOQUIA": 1,
          "BOGOTA": 1,
          "CUNDINAMARCA": 1,
          "TOLIMA": 3
        }
      },
      "participaciones_por_edad": {
        "1-5 a√±os": 1,
        "11-15 a√±os": 19,
        "16-20 a√±os": 16,
        "21-25 a√±os": 23,
        "26-30 a√±os": 57,
        "31-35 a√±os": 54,
        "36-40 a√±os": 26,
        "41-45 a√±os": 19,
        "46-50 a√±os": 10,
        "51-55 a√±os": 1,
        "56-60 a√±os": 1,
        "6-10 a√±os": 2
      }
    }
  }
};

        // Funci√≥n para corregir ortograf√≠a de departamentos
        function corregirOrtografiaDepartamento(nombre) {
            const correcciones = {
                'NARINO': 'Nari√±o',
                'QUINDIO': 'Quind√≠o',
                'BOGOTA': 'Bogot√°',
                'VALLE': 'Valle del Cauca',
                'ANTIOQUIA': 'Antioquia',
                'ARAUCA': 'Arauca',
                'CALDAS': 'Caldas',
                'CASANARE': 'Casanare',
                'CAUCA': 'Cauca',
                'CESAR': 'Cesar',
                'CUNDINAMARCA': 'Cundinamarca',
                'HUILA': 'Huila',
                'META': 'Meta',
                'PUTUMAYO': 'Putumayo',
                'RISARALDA': 'Risaralda',
                'SANTANDER': 'Santander',
                'TOLIMA': 'Tolima'
            };
            return correcciones[nombre] || nombre;
        }

        document.addEventListener('DOMContentLoaded', function() {
            renderizarEstadisticas();
            renderizarEdad();
            renderizarCategorias();
            renderizarLigas();
            renderizarCategoriaLiga();
        });

        function renderizarEstadisticas() {
            const statsGrid = document.getElementById('statsGrid');
            const totalCategorias = Object.keys(datos.pilotos_por_categoria).length;
            const totalLigas = Object.keys(datos.deportistas_por_liga_total).length;

            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="number">${datos.total_pilotos_unicos}</div>
                    <div class="label">Licencias √önicas</div>
                </div>
                <div class="stat-card">
                    <div class="number">${datos.total_participaciones}</div>
                    <div class="label">Total Participaciones</div>
                </div>
                <div class="stat-card">
                    <div class="number">${totalCategorias}</div>
                    <div class="label">Categor√≠as</div>
                </div>
                <div class="stat-card">
                    <div class="number">${totalLigas}</div>
                    <div class="label">Ligas</div>
                </div>
            `;
        }

        function renderizarCategorias() {
            const chart = document.getElementById('categoriaChart');
            const categorias = Object.entries(datos.pilotos_por_categoria)
                .sort((a, b) => b[1] - a[1]);

            const maxValue = Math.max(...categorias.map(([, v]) => v), 1);

            chart.innerHTML = categorias.map(([categoria, cantidad]) => {
                const porcentaje = (cantidad / maxValue) * 100;
                return `
                    <div class="bar-item">
                        <div class="bar-label">${categoria}</div>
                        <div class="bar-wrapper">
                            <div class="bar-fill" style="width: ${porcentaje}%">
                                ${cantidad}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderizarLigas() {
            const chart = document.getElementById('ligasChart');
            let ligas = Object.entries(datos.deportistas_por_liga_total);
            let sortBy = 'cantidad-desc';

            function aplicarFiltros() {
                const search = document.getElementById('searchLiga').value.toLowerCase();
                sortBy = document.getElementById('filterSortLiga').value;

                let ligasFiltradas = ligas.filter(([liga]) => {
                    const ligaCorregida = corregirOrtografiaDepartamento(liga);
                    return ligaCorregida.toLowerCase().includes(search) || liga.toLowerCase().includes(search);
                });

                ligasFiltradas.sort((a, b) => {
                    switch(sortBy) {
                        case 'cantidad-desc':
                            return b[1] - a[1];
                        case 'cantidad-asc':
                            return a[1] - b[1];
                        case 'nombre-asc':
                            return a[0].localeCompare(b[0]);
                        case 'nombre-desc':
                            return b[0].localeCompare(a[0]);
                        default:
                            return b[1] - a[1];
                    }
                });

                const maxValue = Math.max(...ligasFiltradas.map(([, v]) => v), 1);

                chart.innerHTML = ligasFiltradas.map(([liga, cantidad]) => {
                    const porcentaje = (cantidad / maxValue) * 100;
                    const ligaCorregida = corregirOrtografiaDepartamento(liga);
                    return `
                        <div class="bar-item">
                            <div class="bar-label">${ligaCorregida}</div>
                            <div class="bar-wrapper">
                                <div class="bar-fill" style="width: ${porcentaje}%">
                                    ${cantidad}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            document.getElementById('searchLiga').addEventListener('input', aplicarFiltros);
            document.getElementById('filterSortLiga').addEventListener('change', aplicarFiltros);
            aplicarFiltros();
        }

        function renderizarCategoriaLiga() {
            const container = document.getElementById('todasCategoriasLigaCharts');
            const filtroSelect = document.getElementById('filtroCategoriaLiga');
            const categorias = Object.keys(datos.deportistas_por_liga_categoria).sort();

            // Llenar el selector con todas las categor√≠as
            filtroSelect.innerHTML = '<option value=\"\">Seleccione un filtro</option>' +
                '<option value=\"todas\">Mostrar todas las categor√≠as</option>' +
                categorias.map(cat => 
                    `<option value="${cat}">${cat}</option>`
                ).join('');

            function mostrarGraficas(categoriaFiltro) {
                // Si no hay filtro seleccionado, no mostrar nada
                if (!categoriaFiltro || categoriaFiltro === '') {
                    container.innerHTML = '';
                    return;
                }
                
                // Si se selecciona "todas", mostrar todas las categor√≠as
                const categoriasAMostrar = categoriaFiltro === 'todas' 
                    ? categorias 
                    : [categoriaFiltro];

                container.innerHTML = categoriasAMostrar.map(categoria => {
                    const ligas = Object.entries(datos.deportistas_por_liga_categoria[categoria] || {})
                        .sort((a, b) => b[1] - a[1]);

                    if (ligas.length === 0) {
                        return '';
                    }

                    const maxValue = Math.max(...ligas.map(([, v]) => v), 1);
                    const maxHeight = 200; // Altura m√°xima de las columnas

                    const chartHTML = ligas.map(([liga, cantidad]) => {
                        const altura = (cantidad / maxValue) * maxHeight;
                        const ligaCorregida = corregirOrtografiaDepartamento(liga);
                        return `
                            <div class="column-item">
                                <div class="column-wrapper">
                                    <div class="column-fill" style="height: ${altura}px">
                                        ${cantidad}
                                    </div>
                                </div>
                                <div class="column-label">${ligaCorregida}</div>
                            </div>
                        `;
                    }).join('');

                    return `
                        <div style="margin-bottom: 40px;">
                            <h3 style="color: #123E92; margin-bottom: 20px; font-size: 1.3em; padding-bottom: 10px; border-bottom: 2px solid #F7C31D;">${categoria}</h3>
                            <div class="chart-container">
                                <div class="column-chart">
                                    ${chartHTML}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // No mostrar nada por defecto (esperar a que el usuario seleccione un filtro)
            container.innerHTML = '';

            // Event listener para el filtro
            filtroSelect.addEventListener('change', function() {
                mostrarGraficas(this.value);
            });
        }

        function renderizarEdad() {
            const chart = document.getElementById('edadChart');
            const edades = Object.entries(datos.participaciones_por_edad || {});
            
            if (edades.length === 0) {
                chart.innerHTML = '<p style="text-align: center; padding: 40px; color: #666;">No hay datos de edad disponibles</p>';
                return;
            }

            // Ordenar por orden de edad (rango de 5 a√±os, empezando desde 1-5)
            const ordenEdades = [
                "0 a√±os", "1-5 a√±os", "6-10 a√±os", "11-15 a√±os", "16-20 a√±os", 
                "21-25 a√±os", "26-30 a√±os", "31-35 a√±os", "36-40 a√±os",
                "41-45 a√±os", "46-50 a√±os", "51-55 a√±os", "56-60 a√±os",
                "61-65 a√±os", "66+ a√±os"
            ];
            
            edades.sort((a, b) => {
                const idxA = ordenEdades.indexOf(a[0]);
                const idxB = ordenEdades.indexOf(b[0]);
                if (idxA === -1 && idxB === -1) return a[0].localeCompare(b[0]);
                if (idxA === -1) return 1;
                if (idxB === -1) return -1;
                return idxA - idxB;
            });

            const maxValue = Math.max(...edades.map(([, v]) => v), 1);
            const maxHeight = 250;

            chart.innerHTML = edades.map(([rango, cantidad]) => {
                const altura = (cantidad / maxValue) * maxHeight;
                return `
                    <div class="column-item">
                        <div class="column-wrapper">
                            <div class="column-fill" style="height: ${altura}px">
                                ${cantidad}
                            </div>
                        </div>
                        <div class="column-label">${rango}</div>
                    </div>
                `;
            }).join('');
        }

        // El men√∫ se carga din√°micamente desde menu.html usando load-menu.js

        // Funci√≥n para descargar el informe como PDF
        document.getElementById('descargarPDF').addEventListener('click', function() {
            const button = this;
            const buttonContainer = button.parentElement;
            const originalText = button.innerHTML;
            
            // Mostrar modal de carga con SweetAlert
            Swal.fire({
                title: 'Generando PDF',
                html: 'Por favor espere mientras se genera el documento...',
                allowOutsideClick: false,
                allowEscapeKey: false,
                showConfirmButton: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            // Deshabilitar el bot√≥n pero mantenerlo visible
            button.disabled = true;
            button.style.opacity = '0.7';
            button.style.cursor = 'not-allowed';
            button.innerHTML = '‚è≥ Generando PDF...';

            // Ocultar el contenedor del bot√≥n temporalmente para que no aparezca en el PDF
            const originalDisplay = buttonContainer.style.display;
            buttonContainer.style.display = 'none';

            // Capturar el contenido del contenedor principal
            const element = document.querySelector('.container');
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff',
                windowWidth: element.scrollWidth,
                windowHeight: element.scrollHeight
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const imgWidth = 210; // Ancho A4 en mm
                const pageHeight = 297; // Alto A4 en mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                // Agregar primera p√°gina
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                // Agregar p√°ginas adicionales si el contenido es m√°s largo que una p√°gina
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                // Descargar el PDF
                const nombreArchivo = 'III_VAL_copa_dream_expirience_informe.pdf';
                pdf.save(nombreArchivo);

                // Cerrar el modal y mostrar √©xito
                Swal.fire({
                    icon: 'success',
                    title: 'PDF generado',
                    text: 'El informe se ha descargado correctamente',
                    confirmButtonColor: '#123E92',
                    timer: 2000,
                    timerProgressBar: true
                });

                // Restaurar el contenedor del bot√≥n (siempre centrado)
                buttonContainer.style.display = originalDisplay || 'block';
                button.innerHTML = originalText;
                button.disabled = false;
                button.style.opacity = '1';
                button.style.cursor = 'pointer';
            }).catch(error => {
                console.error('Error al generar PDF:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo generar el PDF. Por favor, intente nuevamente.',
                    confirmButtonColor: '#123E92'
                });
                buttonContainer.style.display = originalDisplay || 'block';
                button.innerHTML = originalText;
                button.disabled = false;
                button.style.opacity = '1';
                button.style.cursor = 'pointer';
            });
        });
    </script>
    
    <!-- Script para cargar el men√∫ din√°micamente -->
    <script src="../../load-menu.js"></script>
    
    <!-- Script para manejar el bot√≥n PDF de forma responsive -->
    <script src="../../pdf-button-responsive.js"></script>
    <!-- Script para prevenir scroll autom√°tico al recargar -->
    <script>
        // Prevenir scroll autom√°tico al recargar la p√°gina
        if ('scrollRestoration' in history) {
            history.scrollRestoration = 'manual';
        }
        
        // Asegurar que la p√°gina comience en la parte superior
        window.addEventListener('beforeunload', function() {
            window.scrollTo(0, 0);
        });
        
        // Asegurar posici√≥n inicial al cargar
        window.addEventListener('load', function() {
            window.scrollTo(0, 0);
            // Peque√±o delay para asegurar que el men√∫ se haya cargado
            setTimeout(function() {
                window.scrollTo(0, 0);
            }, 100);
        });
    </script>
</body>
</html>
